<!DOCTYPE html>
<html lang="en" class="h-full dark">
{{- /*gotype: github.com/joschahenningsen/TUM-Live/web.WatchPageData*/ -}}
<head>
    <meta charset="UTF-8">
    {{$stream := .IndexData.TUMLiveContext.Stream}}
    {{$course := .IndexData.TUMLiveContext.Course}}
    <title>{{$course.Name}}: {{$stream.Name}} | TUM Live</title>
    {{template "headImports" .IndexData.VersionTag}}
    <script>window.HELP_IMPROVE_VIDEOJS = false;</script>
    <script src="/static/assets/ts-dist/watch.bundle.js?v={{.IndexData.VersionTag}}"></script>
    <link rel="stylesheet" href="/static/node_modules/video.js/dist/video-js.min.css">
    <link rel="stylesheet" href="/static/node_modules/videojs-seek-buttons/dist/videojs-seek-buttons.css">
    <link rel="stylesheet" href="/static/node_modules/@silvermine/videojs-airplay/dist/silvermine-videojs-airplay.css">
    <link rel="stylesheet"
          href="/static/node_modules/videojs-hls-quality-selector/dist/videojs-hls-quality-selector.css">
</head>
<body x-data="{'paused': {{$stream.Paused}}, 'streamID': {{$stream.Model.ID}}}"
      x-on:pausestart.window="paused=true"
      x-on:pauseend.window="paused=false"
      x-init="new watch.Watch(); watch.startWebsocket()">
{{template "header" .IndexData.TUMLiveContext}}
<div id="watchPageMainWrapper" class="w-full md:flex md:flex-nowrap md:justify-between"
     style="height: calc(100vh - 5rem)">
    <input type="hidden" id="streamID" value="{{$stream.Model.ID}}">
    <div id="watchWrapper"
         class="grow overflow-x-hidden h-fit md:h-full">
        <noscript><p class="vjs-no-js">
                To view this video please enable JavaScript.
            </p></noscript>
        <div id="watchContent"
             x-data="{ contextMenu: { shown: false, locX: 0, locY: 0 }, videoStatsShown: false }"
             class="w-full relative">
            <div class="bg-indigo-700 bg-opacity-20 border-t-4 border-indigo-700 w-full font-semibold text-2 rounded-t display-none"
                 x-show="paused" x-cloak>
                <i class="fas fa-info-circle"></i> This lecture is currently paused.
            </div>
            <div x-data="{ showliveended: false }" class="bg-red-700 bg-opacity-20 p-2 w-full font-semibold text-2"
                 x-show="showliveended" @streamended.window="showliveended=true" x-cloak>
                <i class="fas fa-info-circle"></i> This livestream has ended.
            </div>
            <video-js
                    id="my-video"
                    class="video-js w-full vjs-theater-mode theater-mode"
                    controls
                    preload="auto"
                    x-on:contextmenu="contextMenu = watch.contextMenuHandler($event, contextMenu)"
                    {{if or .IndexData.TUMLiveContext.Stream.LiveNow .IndexData.TUMLiveContext.Stream.Recording}}poster="/public/default_banner.jpg">
                {{else}}poster="/public/no_active_stream.jpg">{{end}}
                {{if or .IndexData.TUMLiveContext.Stream.LiveNow .IndexData.TUMLiveContext.Stream.Recording}}
                    {{if not $stream.LiveNow}}
                        <source src="{{if eq .Version "PRES"}}{{$stream.PlaylistUrlPRES}}{{else if eq .Version "CAM"}}{{$stream.PlaylistUrlCAM}}{{else}}{{$stream.PlaylistUrl}}{{end}}{{if .Unit}}?wowzaplaystart={{.Unit.UnitStart}}&wowzaplayduration={{.Unit.GetUnitDurationMS}}{{else if $stream.StartOffset}}?wowzaplaystart={{$stream.StartOffset}}&wowzaplayduration={{$stream.EndOffset}}{{end}}"
                                type="application/x-mpegURL"/>
                    {{else}}
                        {{if eq .Version "CAM"}}
                            <source src="{{$stream.PlaylistUrlCAM}}{{.DVR}}" type="application/x-mpegURL"/>
                        {{else if eq .Version "PRES"}}
                            <source src="{{$stream.PlaylistUrlPRES}}{{.DVR}}" type="application/x-mpegURL"/>
                        {{else}}
                            <source src="{{$stream.PlaylistUrl}}{{.DVR}}" type="application/x-mpegURL"/>
                        {{end}}
                    {{end}}
                {{end}}
                <p class="vjs-no-js">
                    To view this video please enable JavaScript.
                </p>
            </video-js>

            <div
                    x-data="{ visible: false, seekbar: { x: '0px', width: '0px' }, seekLogger: new watch.SeekLogger('{{$stream.ID}}') }"
                    x-show="visible"
                    x-on:updateheatmap.window="e => {visible = e.detail.visible; seekbar = e.detail.seekbar;}"
                    x-init="seekLogger.attach(); watch.repeatHeatMap.init();"
                    class="absolute bottom-[18px] rounded bg-gradient-to-t from-gray-800/[.6] pt-4 pointer-events-none"
                    :style="{width: seekbar.width, left: seekbar.x}"
            >
                <svg height="100%" preserveAspectRatio="none" viewBox="0 0 1000 100"
                     width="100%" style="height: 30px;">
                    <defs>
                        <clipPath id="heatmap">
                            <path class="ytp-heat-map-path"
                                  d="M 0.0,100.0 C 1.0,89.5 2.0,55.4 5.0,47.3 C 8.0,39.2 11.0,55.7 15.0,59.4 C 19.0,63.0 21.0,63.1 25.0,65.6 C 29.0,68.0 31.0,69.6 35.0,71.6 C 39.0,73.5 41.0,73.8 45.0,75.3 C 49.0,76.9 51.0,77.7 55.0,79.4 C 59.0,81.0 61.0,82.1 65.0,83.6 C 69.0,85.1 71.0,85.8 75.0,86.8 C 79.0,87.8 81.0,88.0 85.0,88.5 C 89.0,89.0 91.0,89.1 95.0,89.3 C 99.0,89.4 101.0,89.1 105.0,89.2 C 109.0,89.3 111.0,89.5 115.0,89.7 C 119.0,89.8 121.0,89.9 125.0,90.0 C 129.0,90.1 131.0,90.0 135.0,90.0 C 139.0,90.0 141.0,90.0 145.0,90.0 C 149.0,90.0 151.0,90.0 155.0,90.0 C 159.0,90.0 161.0,90.0 165.0,90.0 C 169.0,90.0 171.0,90.0 175.0,90.0 C 179.0,90.0 181.0,90.0 185.0,90.0 C 189.0,90.0 191.0,90.0 195.0,90.0 C 199.0,90.0 201.0,90.0 205.0,90.0 C 209.0,90.0 211.0,90.0 215.0,90.0 C 219.0,90.0 221.0,90.0 225.0,90.0 C 229.0,90.0 231.0,90.0 235.0,90.0 C 239.0,90.0 241.0,90.0 245.0,90.0 C 249.0,90.0 251.0,90.0 255.0,90.0 C 259.0,90.0 261.0,90.0 265.0,90.0 C 269.0,90.0 271.0,90.0 275.0,90.0 C 279.0,90.0 281.0,90.0 285.0,90.0 C 289.0,90.0 291.0,90.0 295.0,90.0 C 299.0,90.0 301.0,90.0 305.0,90.0 C 309.0,90.0 311.0,90.0 315.0,90.0 C 319.0,90.0 321.0,90.0 325.0,90.0 C 329.0,90.0 331.0,90.0 335.0,90.0 C 339.0,90.0 341.0,90.0 345.0,90.0 C 349.0,90.0 351.0,90.0 355.0,90.0 C 359.0,90.0 361.0,90.0 365.0,90.0 C 369.0,90.0 371.0,90.0 375.0,90.0 C 379.0,90.0 381.0,90.0 385.0,90.0 C 389.0,90.0 391.0,90.0 395.0,90.0 C 399.0,90.0 401.0,90.0 405.0,90.0 C 409.0,90.0 411.0,90.0 415.0,90.0 C 419.0,90.0 421.0,90.0 425.0,90.0 C 429.0,90.0 431.0,90.0 435.0,90.0 C 439.0,90.0 441.0,90.0 445.0,90.0 C 449.0,90.0 451.0,90.5 455.0,90.0 C 459.0,89.5 461.0,88.4 465.0,87.7 C 469.0,87.0 471.0,87.0 475.0,86.7 C 479.0,86.3 481.0,85.8 485.0,85.9 C 489.0,86.0 491.0,86.7 495.0,87.0 C 499.0,87.4 501.0,87.4 505.0,87.6 C 509.0,87.8 511.0,88.1 515.0,88.1 C 519.0,88.1 521.0,87.9 525.0,87.6 C 529.0,87.4 531.0,87.6 535.0,86.7 C 539.0,85.8 541.0,84.9 545.0,83.3 C 549.0,81.6 551.0,81.2 555.0,78.3 C 559.0,75.5 561.0,73.0 565.0,69.0 C 569.0,65.0 571.0,62.1 575.0,58.4 C 579.0,54.6 581.0,54.5 585.0,50.1 C 589.0,45.6 591.0,42.4 595.0,36.1 C 599.0,29.7 601.0,25.1 605.0,18.4 C 609.0,11.7 611.0,6.3 615.0,2.6 C 619.0,-1.0 621.0,-1.4 625.0,0.0 C 629.0,1.4 631.0,5.6 635.0,9.6 C 639.0,13.7 641.0,16.8 645.0,20.2 C 649.0,23.6 651.0,25.2 655.0,26.6 C 659.0,28.1 661.0,26.7 665.0,27.3 C 669.0,27.8 671.0,28.3 675.0,29.5 C 679.0,30.6 681.0,31.1 685.0,32.8 C 689.0,34.5 691.0,36.2 695.0,37.9 C 699.0,39.6 701.0,39.3 705.0,41.5 C 709.0,43.6 711.0,46.0 715.0,48.6 C 719.0,51.3 721.0,52.5 725.0,54.7 C 729.0,56.9 731.0,57.7 735.0,59.8 C 739.0,61.8 741.0,63.8 745.0,65.0 C 749.0,66.2 751.0,65.4 755.0,65.7 C 759.0,66.0 761.0,66.3 765.0,66.5 C 769.0,66.7 771.0,66.8 775.0,66.6 C 779.0,66.4 781.0,66.2 785.0,65.6 C 789.0,65.0 791.0,63.7 795.0,63.5 C 799.0,63.3 801.0,64.7 805.0,64.6 C 809.0,64.6 811.0,63.5 815.0,63.1 C 819.0,62.6 821.0,62.0 825.0,62.3 C 829.0,62.6 831.0,64.1 835.0,64.7 C 839.0,65.3 841.0,65.2 845.0,65.5 C 849.0,65.8 851.0,66.0 855.0,66.1 C 859.0,66.2 861.0,66.0 865.0,66.1 C 869.0,66.2 871.0,66.4 875.0,66.8 C 879.0,67.1 881.0,67.0 885.0,67.7 C 889.0,68.4 891.0,69.6 895.0,70.2 C 899.0,70.9 901.0,70.4 905.0,70.9 C 909.0,71.4 911.0,71.9 915.0,72.8 C 919.0,73.8 921.0,74.8 925.0,75.8 C 929.0,76.7 931.0,77.2 935.0,77.7 C 939.0,78.3 941.0,78.5 945.0,78.7 C 949.0,78.8 951.0,78.8 955.0,78.6 C 959.0,78.4 961.0,77.8 965.0,77.8 C 969.0,77.7 971.0,78.3 975.0,78.3 C 979.0,78.4 981.0,78.5 985.0,78.0 C 989.0,77.6 992.0,76.5 995.0,76.1 C 998.0,75.7 999.0,71.3 1000.0,76.1 C 1001.0,80.9 1000.0,95.2 1000.0,100.0"
                                  fill="white" fill-opacity="0.6"></path>
                        </clipPath>
                    </defs>
                    <rect clip-path="url(#heatmap)" fill="white" fill-opacity="0.4" height="100%" width="100%" x="0" y="0"></rect>
                </svg>
            </div>

            <div
                    x-cloak
                    x-show="contextMenu.shown"
                    @click.outside="contextMenu = {...contextMenu, shown: false}"
                    class="origin-top-left absolute w-72 py-2 bg-gray-800/[.9] border-gray-100 border-1 rounded text-white text-sm"
                    :style="{ top: contextMenu.locY + 'px', left: contextMenu.locX + 'px' }"
                    role="menu" aria-orientation="vertical" tabindex="-1">
                <button @click="contextMenu = {...contextMenu, shown: false}; videoStatsShown = true; watch.videoStatListener.listen();"
                        class="py-2 px-4 w-full text-left cursor-pointer hover:bg-white/10">
                    Show detailed stats
                </button>
            </div>

            <div
                    x-cloak
                    x-data="{ data: { bufferSeconds: 0, videoHeight: 0, videoWidth: 0, bandwidth: 0, mediaRequests: 0, mediaRequestsFailed: 0 } }"
                    x-show="videoStatsShown"
                    x-on:newvideostats.window="e => { data = e.detail }"
                    class="origin-top-left absolute w-72 p-4 bg-gray-800/[.9] border-gray-100 border-1 rounded text-white text-sm"
                    :style="{ top: '5px', left: '5px' }"
                    role="menu" aria-orientation="vertical" tabindex="-1">
                <div class="flex justify-between align-middle pb-4">
                    <h3>Video Stats</h3>
                    <button class="px-2 text-l" @click="watch.videoStatListener.clear(); videoStatsShown = false;">
                        <i class="fas fa-close"></i>
                    </button>
                </div>
                <div class="flex justify-between align-middle">
                    <div>
                        <div>Resolution:</div>
                        <div>Bandwidth:</div>
                    </div>
                    <div class="pr-4">
                        <div class="text-right" x-text="`${data.videoWidth}x${data.videoHeight}`"></div>
                        <div class="text-right" x-text="Math.round(data.bandwidth / 1000000) + ' MBit/s'"></div>
                    </div>
                </div>
                <br>
                <div>Buffer:</div>
                <div class="flex justify-between align-middle">
                    <div>
                        <div class="pl-2">> Buffered Time:</div>
                        <div class="pl-2">> Chunks Requested:</div>
                        <div class="pl-2">> Requests Failed:</div>
                    </div>
                    <div class="pr-4">
                        <div class="text-right" x-text="(Math.round(data.bufferSeconds * 100) / 100) + 's'"></div>
                        <div class="text-right" x-text="data.mediaRequests"></div>
                        <div class="text-right" x-text="data.mediaRequestsFailed"></div>
                    </div>
                </div>

            </div>
        </div>
        <div id="streamInfo" class="mx-5 m-auto divide-y dark:divide-gray-800 divide-solid space-y-4 space-y-reverse">
            <!-- Title, course name, actions -->
            <div class="m-auto pb-2">
                <div class="flex justify-between align-middle mt-4 m-auto">
                    <h1 class="text-4 text-xl grow m-auto" @titleupdate.window="$el.innerText=$event.detail.title">
                        {{if $stream.Name}}
                            {{$stream.Name}}
                        {{else}}
                            Lecture: {{$stream.Start.Month}} {{printf "%02d." $stream.Start.Day}} {{$stream.Start.Year}}
                        {{end}}
                    </h1>
                    <!-- Desktop stream info -->
                    <span class="space-x-2 text-lg text-4 hidden sm:inline-flex shrink-0">
                        {{if not $stream.Recording}}
                            {{template "watch-info" .}}
                        {{end}}
                        {{template "actions" .}}
                    </span>
                </div>
                <div class="flex justify-between flex-col sm:flex-row">
                    <div class="flex my-auto">
                        <a href="/course/{{$course.Year}}/{{$course.TeachingTerm}}/{{$course.Slug}}">
                            <span class="text-5 hover:text-1 hover:underline text-lg">{{$course.Name}}</span></a>
                        {{if or (.IndexData.TUMLiveContext.User.IsAdminOfCourse .IndexData.TUMLiveContext.Course) .IndexData.IsAdmin}}
                            <a class="hover:bg-gray-200 dark:hover:bg-gray-600 text-5 hover:text-1 w-fit m-2 px-1 inline-block rounded my-auto"
                               href="/admin/course/{{$course.Model.ID}}#lecture-li-{{$stream.Model.ID}}"
                               :title="'Edit course settings'">
                        <span class="font-semibold text-sm">
                           <i class="fa-solid w-fit py-1 fa-pen"></i>
                        </span>
                            </a>
                        {{end}}
                    </div>
                    {{if $stream.LiveNow}}
                        {{if .DVR}}
                            <a href="./{{$stream.Model.ID}}"><span class="text-5 hover:text-1 hover:underline text-lg">Disable Beta stream</span></a>
                        {{else}}
                            <a href="?dvr"><span
                                        class="text-5 hover:text-1 hover:underline text-lg">Enable Timeshift (beta)</span></a>
                        {{end}}
                    {{end}}
                </div>
                {{if not $stream.Recording}}
                    <div class="block space-x-2 text-lg text-4 sm:hidden">
                        {{template "watch-info" .}}
                    </div>
                {{end}}
                <div class="block space-x-2 text-lg text-4 sm:hidden">
                    {{template "actions" .}}
                </div>
            </div>
            {{if and .IsAdminOfCourse $stream.LiveNow}}
                <!-- Admin control buttons -->
                <div class="pt-4">
                    <h6 class="font-bold text-3 pb-3 ml-1"><i class="fa-solid fa-wrench mr-1"></i>Admin controls
                    </h6>
                    <div class="md:space-x-2 lg:space-y-0 space-y-2 px-2 ">
                        {{/* Lecture hall is set, means no self-stream*/}}
                        {{if $stream.LectureHallID}}
                            <button @click="fetch(`/api/stream/${streamID}/pause?pause=${!paused}`).then(paused=!paused)"
                                    href="#"
                                    :title="paused?'End Pause (turns on video and audio)':'Pause lecture (turns off video and audio)'"
                                    class="bg-green-500 text-center lg:w-32 md:w-24 md:inline-block block w-full text-white font-bold hover:bg-green-600 dark:hover:bg-green-600 rounded cursor-pointer p-2">
                                <span x-show="!paused"><i class="fas fa-pause mr-1"></i>Pause</span>
                                <span x-show="paused"><i class="fas fa-play mr-1"></i>Resume</span>
                            </button>
                            <button @click="window.location.href='?restart=1'"
                                    title="Issues with the stream? Restart it."
                                    class="bg-indigo-500 text-center lg:w-32 md:w-24 md:inline-block block w-full text-white font-bold hover:bg-indigo-600 dark:hover:bg-indigo-600 rounded cursor-pointer p-2">
                                <i class="fas fa-redo mr-1"></i>Restart
                            </button>
                            <button @click="$dispatch('stop')"
                                    title="Already finished? End the stream early."
                                    class="bg-red-500 text-center lg:w-32 md:w-24 md:inline-block block w-full text-white hover:bg-red-600 font-bold dark:hover:bg-red-600 rounded cursor-pointer p-2">
                                <i class="fas fa-power-off mr-1"></i>Stop
                            </button>
                        {{end}}
                        {{if .AlertsEnabled}}
                            <button @click="$dispatch('issue');location.href='#';location.href='#alertModal'"
                                    title="Issues with the stream? Send a report to the RGB."
                                    class="bg-amber-500 text-center md:w-28 md:inline-block block lg:w-32 {{if $stream.LectureHallID}}md:float-right{{end}} w-full text-white font-bold hover:bg-amber-700 dark:hover:bg-amber-700 rounded cursor-pointer p-2">
                                <i class="fas fa-exclamation-triangle mr-1"></i>Problem
                            </button>
                        {{end}}
                    </div>
                </div>
                {{if .Presets}}
                    <div class="pt-2">
                        <h6 class="font-bold text-3 pb-3 ml-1"><i class="fa-solid fa-camera mr-1"></i>Presets
                            for {{.LectureHallName}}</h6>
                        <div class="w-full overflow-x-scroll scrollbarThin">
                            <div class="flex flex-row gap-x-2 pb-4 pl-2">
                                {{range $preset := .Presets}}
                                    <div style="min-width: 150px" class="text-center relative group">
                                        <img id="presetImage{{$preset.LectureHallId}}-{{$preset.PresetID}}"
                                             src="/public/{{if $preset.Image}}{{$preset.Image}}{{else}}noPreset.jpg{{end}}"
                                             alt="prev" width="150px"
                                             class="border-1 dark:border-slate-400 border-slate-500 rounded-lg">
                                        <i onclick="watch.usePreset({{$course.Model.ID}}, {{$preset.LectureHallId}}, {{$preset.PresetID}})"
                                           title="Switch to this preset"
                                           class="opacity-0 group-hover:opacity-100 absolute top-1 right-1 p-1 rounded text-white bg-info fas fa-exchange-alt cursor-pointer"></i>
                                    </div>
                                {{end}}
                            </div>
                        </div>
                    </div>
                {{end}}
            {{end}}
            <!-- Video Sections -->
            {{if $stream.VideoSections}}
                {{template "videosections" $stream}}
            {{end}}
            <!-- Video description -->
            <div x-data="{ less: {{len .Description}}>{{.CutOffLength}}, full: `{{.Description}}`, prev: `{{.TruncatedDescription}}` }"
                 class="text-3 pt-2 video-description"
                 x-show="full.length"
            >
                <h6 class="font-bold text-3 pb-3 ml-1"><i class="fa-solid fa-circle-info mr-1"></i>Description
                </h6>
                <div class="text-3 px-2"
                     x-html="less ? prev : full"
                     @descriptionupdate.window="full=$el.innerHTML=$event.detail.description.full;prev=
                    $el.innerHTML=$event.detail.description.truncated;less=full.length>{{.CutOffLength}};">
                </div>
                <button x-show="full.length>{{.CutOffLength}}"
                        class="text-xs text-gray-500 dark:text-gray-400 uppercase mt-2 px-2"
                        @click="less = !less" x-text="less ? 'show more' : 'show less'">
                </button>
            </div>
            <!-- Modal when stopping a stream -->
            <div class="inline-block" x-data="{ 'showModal': false }"
                 @stop.window="showModal=true"
                 @keydown.escape="showModal = false" x-cloak x-show="showModal">
                <section class="flex flex-wrap h-full">
                    <div class="overflow-auto" x-show="showModal"
                         :class="{ 'absolute inset-0 z-10 flex items-center justify-center': showModal }">
                        <div class="dark:bg-secondary-light bg-gray-200 text-3 absolute transform -translate-x-1/2 -translate-y-1/2 left-1/2 top-1/2 w-auto md:max-w-md mx-auto rounded shadow-lg py-4 text-left
                        px-6"
                             @click.away="showModal = false">
                            <!--Title-->
                            <div class="flex justify-between pb-3">
                                <p class="text-2 font-bold">Keep the recording after ending the stream?</p>
                            </div>
                            <!--Footer-->
                            <div class="flex justify-start pt-2">
                                <button class="bg-green-500 inline-block text-center w-24 text-white hover:bg-green-600 dark:hover:bg-green-600 font-bold rounded cursor-pointer p-1 mr-3"
                                        @click="fetch(`/api/stream/${streamID}/end?discard=${false}`).then(showModal=false)">
                                    Yes
                                </button>
                                <button class="bg-red-500 inline-block text-center w-24 text-white hover:bg-red-600 dark:hover:bg-red-600 font-bold rounded cursor-pointer p-1 mr-3"
                                        @click="fetch(`/api/stream/${streamID}/end?discard=${true}`).then(showModal=false)">
                                    No
                                </button>
                                <button class="bg-gray-500 inline-block text-center w-24 text-white hover:bg-gray-600 dark:hover:bg-gray-600 font-bold rounded cursor-pointer p-1"
                                        @click="showModal = false">Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            {{if .AlertsEnabled}}
                {{template "alert-modal" . }}
            {{end}}
            {{if .IsHighlightPage}}
                <ul class="w-full m-auto mb-4">
                    {{template "course_list" .IndexData.TUMLiveContext}}
                </ul>
            {{end}}
        </div>
    </div>
    {{if $course.ChatEnabled}}
        <div x-data="{show: $persist(false).as('chatOpen')}"
             class="mt-5 md:mt-0"
             :class="show ? 'w-full md:w-2/6 2xl:w-1/5 h-96 md:h-auto shrink-0' : 'md:w-14  h-fit md:h-full'">
            {{template "chat" .ChatData}}
        </div>
    {{end}}
</div>
<script>
    {{if $stream.Recording}}
    watch.initPlayer(true, false, false, {{.IndexData.TUMLiveContext.User.GetPlaybackSpeeds.GetEnabled}}, {{$stream.LiveNow}}, {{$stream.GetThumbIdForSource .Version}}, {{$stream.ThumbInterval}}, {{$stream.Model.ID}});
    {{else}}
    watch.initPlayer(true, false, false, {{.IndexData.TUMLiveContext.User.GetPlaybackSpeeds.GetEnabled}}, {{$stream.LiveNow}});
    {{end}}
    {{if and $stream.Recording .IndexData.TUMLiveContext.User}}
    watch.watchProgress({{$stream.Model.ID}}, {{ .Progress.Progress }});
    {{end}}
    {{if $stream.Silences}}
    watch.skipSilence({{$stream.GetSilencesJson}});
    {{end}}
</script>
</body>
</html>
